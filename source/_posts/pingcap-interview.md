---
title: PingCAP 校招面试记
date: 2017-08-12 23:01:16
tags:
- interview
- PingCAP
- System
---

参加了校招季的第一场面试，居然是上周才投的 [PingCAP](https://www.pingcap.com/index-zh)，主要是 HR 的效率非常之高，再加上直接在上海 Office 参加的面试，面试我的大佬也非常的和蔼。

PingCAP 是我比较想去的公司之一，因为本身就对 System 相关的东西有兴趣，之前看过几篇经典的 paper（不过真的尝试实现会感觉很多细节不确定），再加上之前看到 PingCAP 在知乎和微信公众号的分享感觉技术实力非常强，感觉是一个能获得快速成长的地方。

<!-- more -->

由于周二投简历周四收到周六的面试通知这种设定，基本没有时间准备，而且不太清楚面试的形式，这两天有考虑过速成 Rust 然后非常快地过一遍 TiKV 的源码，然后想了想觉得不是很现实，结果这两天一直在认真啃 [TiDB 的知乎专栏](https://zhuanlan.zhihu.com/newsql)（倒是真的感觉有不少收获，更加敬佩了），然后就胆战心惊地去面试了。

然后面试的过程比想象中的轻松很多（轻松而非简单），面试官问了非常多非常杂的问题，基本涉及了计算机本科所有的课程以及大量的项目经历，当中有大量我说不会的就直接跳过了没有追问，感觉底被摸透了。

比较有意思的是问了一道算法题（也是唯一一道，后来我发现他根本不是想问算法），leetcode 通过率最低的 [Valid Number](https://leetcode.com/problems/valid-number/description/)，我说我用正则表达式 A 了，面试官问有没有不用正则的方法，我说可以自己手动把正则的思路展开，他问有没有更优雅的，我说可以写一个状态机来验证合法的数字字符串，他继续追问有没有更优雅的，我确实想不到了，后来他直接登了他的 leetcode 账号，给我 show 了一下他这道题的 200+ 行 Java 代码，大概是先定义了一个语法树，然后添加了 Valid Number 的语法，最后 run 起来就过了，好吧虽然我也会但是实在是觉得太大材小用了所以没想到，面试官说这是他从项目代码里扒出来的语法树然后加了两行 Valid Number 的语法定义而已（摊手）。

回来以后我试图照着他的思路把这道题 A 一遍，后来实在觉得太大材小用了有点拒绝，不过既然打开了这题就顺手把原来的正则改得可读性高一点。

```python
def isNumber(s):
    i = r'\d+'
    oi = r'\d*'
    si = r'[+-]?\d+'

    f = '({})'.format('|'.join([
        i,
        r'{}\.{}'.format(si, oi),
        r'{}\.{}'.format(oi, i),
    ]))

    r = r'^ *[+-]?{}([eE]{})? *$'.format(f, si)

    return re.match(r, s) is not None
```

在面试的最后我提问的环节，问了一直想问的一个问题，为什么 TiKV 会选择 Rust 作为开发语言（当时 Rust 似乎还处于非常不稳定的 0.x 版本），得到了解答，大概意思是，TiKV 的设计必须使用没有 GC 的底层语言，可选的只有 C/C++/Rust 之类的，然后他们觉得 Rust 让程序员更难犯错，毕竟底层的内存泄漏是很致命的，所以选择了 Rust 开发。至于为什么必须没有 GC 的语言，我忘记追问了，我个人猜想是 GC 的 Stop the world 行为会让 [Raft](https://raft.github.io/) 的选举超时时间必须设得足够长，而这样带来的代价是 Leader 崩溃时系统恢复可用性的时间也相应增加。

总之 PingCAP 的面试还是一个很愉快的事情，虽然犯了不少错但感觉很好地展现了自己，不知道有没有达到面试官心中的准入门槛，希望能拿到校招的第一封 offer :)
